<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nh·ªØng con kh·ªâ A5K60 - Trang ch·ªß</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
    
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAbD9ave4WUPk9MndVZ7_3_f5XyhNVepEY",
            authDomain: "a5k60-website.firebaseapp.com",
            databaseURL: "https://a5k60-website-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "a5k60-website",
            storageBucket: "a5k60-website.firebasestorage.app",
            messagingSenderId: "1083754554024",
            appId: "1:1083754554024:web:6847ea23b19a9369dc989d"
        };
        
        firebase.initializeApp(firebaseConfig);
        window.db = firebase.database();
        console.log('‚úÖ Firebase k·∫øt n·ªëi th√†nh c√¥ng!');
    </script>
    
    <style>
        .member-card {
            transition: all 0.3s ease;
        }
        .member-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-6 shadow-lg">
        <div class="container mx-auto px-4 text-center">
            <div class="text-5xl mb-2">üêí</div>
            <h1 class="text-3xl font-bold">Nh·ªØng con kh·ªâ A5K60</h1>
            <p class="text-blue-100 mt-2">C·ªông ƒë·ªìng 46 th√†nh vi√™n ƒë·∫∑c bi·ªát - N∆°i k·∫øt n·ªëi v√† chia s·∫ª</p>
        </div>
    </header>

    <!-- Stats -->
    <section class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-3 gap-4 max-w-2xl mx-auto">
            <div class="bg-white rounded-lg p-4 text-center shadow">
                <div class="text-2xl font-bold text-blue-600">46</div>
                <div class="text-gray-600">Th√†nh vi√™n</div>
            </div>
            <div class="bg-white rounded-lg p-4 text-center shadow">
                <div class="text-2xl font-bold text-green-600">‚àû</div>
                <div class="text-gray-600">K·ª∑ ni·ªám</div>
            </div>
            <div class="bg-white rounded-lg p-4 text-center shadow">
                <div class="text-2xl font-bold text-red-600">‚ô•</div>
                <div class="text-gray-600">T√¨nh b·∫°n</div>
            </div>
        </div>
    </section>

    <!-- Search -->
    <section class="container mx-auto px-4 mb-6">
        <div class="max-w-md mx-auto">
            <div class="relative">
                <input type="text" id="search-input" placeholder="üîç T√¨m th√†nh vi√™n..." 
                       class="w-full px-4 py-3 rounded-full border-2 border-blue-300 focus:border-blue-500 focus:outline-none shadow-sm">
            </div>
        </div>
    </section>

    <!-- Members Grid -->
    <section class="container mx-auto px-4 pb-12">
        <div id="members-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            <!-- Danh s√°ch th√†nh vi√™n s·∫Ω ƒë∆∞·ª£c load t·ª± ƒë·ªông -->
        </div>
        
        <div id="no-results" class="hidden text-center py-12 text-gray-500">
            <div class="text-4xl mb-4">üîç</div>
            <h3 class="text-xl font-semibold">Kh√¥ng t√¨m th·∫•y th√†nh vi√™n</h3>
            <p class="mt-2">Vui l√≤ng th·ª≠ l·∫°i v·ªõi t·ª´ kh√≥a kh√°c</p>
        </div>
    </section>

    <!-- Scripts -->
    <script src="main.js"></script>
    
    <script>
        // H√†m t·∫°o th·∫ª th√†nh vi√™n
        function createMemberCard(memberId, data) {
            const card = document.createElement('div');
            card.className = 'member-card bg-white rounded-lg p-4 shadow-lg cursor-pointer';
            card.setAttribute('data-member-id', memberId);
            
            // T·∫°o HTML cho th·∫ª
            card.innerHTML = `
                <div class="text-center">
                    <img src="${data.avatar || 'https://via.placeholder.com/100x100/4F46E5/FFFFFF?text=üêµ'}" 
                         alt="${data.name || 'Th√†nh vi√™n'}"
                         class="avatar w-20 h-20 rounded-full mx-auto mb-3 object-cover border-4 border-blue-100">
                    <h3 class="member-name font-bold text-lg text-gray-800 mb-1">${data.name || `Th√†nh vi√™n ${memberId}`}</h3>
                    <p class="member-bio text-sm text-gray-600 mb-2">${data.bio || 'Th√†nh vi√™n tuy·ªát v·ªùi c·ªßa nh√≥m A5K60'}</p>
                    <div class="member-hobbies flex flex-wrap justify-center gap-1 mt-2">
                        ${(data.hobbies || []).slice(0, 3).map(hobby => 
                            `<span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full">${hobby}</span>`
                        ).join('')}
                    </div>
                    <div class="text-xs text-gray-400 mt-2">ID: ${memberId}</div>
                </div>
            `;
            
            // Click v√†o th·∫ª ‚Üí v√†o trang c√° nh√¢n
            card.addEventListener('click', () => {
                localStorage.setItem('viewingMemberId', memberId);
                window.location.href = `profile.html?id=${memberId}`;
            });
            
            return card;
        }

        // H√†m load v√† l·∫Øng nghe th√†nh vi√™n real-time
        function initializeMembers() {
            const container = document.getElementById('members-container');
            const noResults = document.getElementById('no-results');
            
            if (!container) {
                console.error('‚ùå Kh√¥ng t√¨m th·∫•y #members-container');
                return;
            }
            
            // L·∫Øng nghe thay ƒë·ªïi real-time t·ª´ Firebase
            db.ref('members').on('value', (snapshot) => {
                console.log('üì° Firebase data received:', snapshot.val());
                
                const members = snapshot.val();
                
                // N·∫øu Firebase ch∆∞a c√≥ data, load t·ª´ localStorage backup
                if (!members) {
                    console.log('‚ö†Ô∏è Firebase tr·ªëng, load t·ª´ localStorage...');
                    for (let i = 1; i <= 46; i++) {
                        const memberId = i.toString().padStart(2, '0');
                        const localData = JSON.parse(localStorage.getItem(`member_${memberId}`) || '{}');
                        const card = createMemberCard(memberId, localData);
                        container.appendChild(card);
                    }
                    return;
                }
                
                // X√≥a danh s√°ch c≈©
                container.innerHTML = '';
                
                // S·∫Øp x·∫øp theo memberId v√† render
                const sortedIds = Object.keys(members).sort((a, b) => parseInt(a) - parseInt(b));
                sortedIds.forEach(memberId => {
                    const card = createMemberCard(memberId, members[memberId]);
                    container.appendChild(card);
                });
                
                // Th√™m hi·ªáu ·ª©ng v√†o
                anime({
                    targets: '.member-card',
                    opacity: [0, 1],
                    translateY: [30, 0],
                    delay: anime.stagger(50),
                    duration: 600,
                    easing: 'easeOutQuad'
                });
                
                console.log(`‚úÖ ƒê√£ load ${sortedIds.length} th√†nh vi√™n t·ª´ Firebase`);
            });
            
            // L·∫Øng nghe khi c√≥ th√†nh vi√™n m·ªõi
            db.ref('members').on('child_added', (snapshot) => {
                console.log(`üì• Th√†nh vi√™n ${snapshot.key} m·ªõi ƒë∆∞·ª£c th√™m`);
            });
            
            // L·∫Øng nghe khi th√†nh vi√™n thay ƒë·ªïi (real-time sync!)
            db.ref('members').on('child_changed', (snapshot) => {
                const memberId = snapshot.key;
                const data = snapshot.val();
                console.log(`üìù Th√†nh vi√™n ${memberId} ƒë√£ c·∫≠p nh·∫≠t:`, data);
                
                // C·∫≠p nh·∫≠t th·∫ª tr·ª±c ti·∫øp n·∫øu t·ªìn t·∫°i
                const existingCard = document.querySelector(`[data-member-id="${memberId}"]`);
                if (existingCard) {
                    existingCard.querySelector('.member-name').textContent = data.name || `Th√†nh vi√™n ${memberId}`;
                    existingCard.querySelector('.member-bio').textContent = data.bio || 'Th√†nh vi√™n tuy·ªát v·ªùi';
                    existingCard.querySelector('.avatar').src = data.avatar || '/default-avatar.png';
                    
                    // Th√™m hi·ªáu ·ª©ng nh·∫•p nh√°y khi c·∫≠p nh·∫≠t
                    anime({
                        targets: existingCard,
                        scale: [1, 1.05, 1],
                        duration: 500,
                        easing: 'easeInOutQuad'
                    });
                }
            });
        }

        // H√†m t√¨m ki·∫øm
        function setupSearch() {
            const searchInput = document.getElementById('search-input');
            const noResults = document.getElementById('no-results');
            
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                const cards = document.querySelectorAll('.member-card');
                let hasResults = false;
                
                cards.forEach(card => {
                    const name = card.querySelector('.member-name').textContent.toLowerCase();
                    const bio = card.querySelector('.member-bio').textContent.toLowerCase();
                    const memberId = card.getAttribute('data-member-id');
                    
                    if (name.includes(query) || bio.includes(query) || memberId.includes(query)) {
                        card.style.display = 'block';
                        hasResults = true;
                    } else {
                        card.style.display = 'none';
                    }
                });
                
                // Hi·ªán/·∫©n th√¥ng b√°o kh√¥ng t√¨m th·∫•y
                if (hasResults || query === '') {
                    noResults.classList.add('hidden');
                } else {
                    noResults.classList.remove('hidden');
                }
            });
        }

        // Kh·ªüi ch·∫°y khi trang t·∫£i
        document.addEventListener('DOMContentLoaded', () => {
            initializeMembers();
            setupSearch();
            console.log('üöÄ Trang ch·ªß ƒë√£ s·∫µn s√†ng!');
        });
    </script>
</body>
</html>
